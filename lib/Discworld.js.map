{"version":3,"sources":["../src/Discworld.ts"],"names":["centuries","defaultLocalisation","name","epochs","monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","digits","undefined","dateFormat","firstDay","isRTL","DiscworldCalendar","BaseCalendar","constructor","language","localisations","leapYear","yearOrDate","CDate","validate","Calendars","local","invalidYear","minMonth","minDay","daysInYear","daysInMonth","month","m","invalidMonth","notDay","daysPerMonth","daysInWeek","dayOfWeek","day","d","invalidDate","weekDay","dow","extraInfo","y","century","Math","floor","toJD","jdEpoch","fromJD","jd","year","date","register"],"mappings":"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","sourcesContent":["/* http://keith-wood.name/worldCalendars.html\r\n   Implementation of the Discworld calendar - Unseen University version.\r\n   See also http://wiki.lspace.org/mediawiki/Discworld_calendar\r\n   and http://discworld.wikia.com/wiki/Discworld_calendar.\r\n   Written by Keith Wood (wood.keith{at}optusnet.com.au) May 2022.\r\n   Available under the MIT (http://keith-wood.name/licence.html) license.\r\n   Please attribute the author if you use it. */\r\n\r\nimport Calendars, { BaseCalendar, CDate } from './Calendars'\r\nimport type { CalendarLocalisation, RegionalLocalisations } from './Calendars'\r\n\r\n// Names of the centuries\r\nconst centuries: string[] = []\r\ncenturies[20] = 'Fruitbat'\r\ncenturies[21] = 'Anchovy'\r\n\r\nconst defaultLocalisation: CalendarLocalisation = {\r\n  name: 'Discworld',\r\n  epochs: ['BUC', 'UC'],\r\n  monthNames: ['Ick', 'Offle', 'February', 'March', 'April', 'May', 'June',\r\n    'Grune', 'August', 'Spune', 'Sektober', 'Ember', 'December'],\r\n  monthNamesShort: ['Ick', 'Off', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Gru', 'Aug', 'Spu', 'Sek', 'Emb', 'Dec'],\r\n  dayNames: ['Sunday', 'Octeday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\r\n  dayNamesShort: ['Sun', 'Oct', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\r\n  dayNamesMin: ['Su', 'Oc', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],\r\n  digits: undefined,\r\n  dateFormat: 'yyyy/mm/dd',\r\n  firstDay: 2,\r\n  isRTL: false\r\n}\r\n\r\nclass DiscworldCalendar extends BaseCalendar {\r\n  // Localisations for the plugin.\r\n  // Entries are objects indexed by the language code ('' being the default US/English). */\r\n  static localisations: RegionalLocalisations = { '': defaultLocalisation }\r\n\r\n  constructor (language: string = '') {\r\n    // Julian date of start of Discworld epoch: 1 January 0001 CE (Gregorian)\r\n    super('Discworld', 1721425.5, DiscworldCalendar.localisations[language] || DiscworldCalendar.localisations[''],\r\n      [16, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32], 13)\r\n  }\r\n\r\n  // Determine whether this date is in a leap year.\r\n  leapYear(date: CDate): boolean;\r\n  leapYear(year: number): boolean;\r\n  leapYear (yearOrDate: CDate | number): boolean {\r\n    yearOrDate instanceof CDate\r\n      ? this.validate('', yearOrDate)\r\n      : this.validate(Calendars.local.invalidYear, yearOrDate, this.minMonth, this.minDay)\r\n    return false\r\n  }\r\n\r\n  // Retrieve the number of days in a year.\r\n  daysInYear (yearOrDate: CDate | number): number {\r\n    yearOrDate instanceof CDate\r\n      ? this.validate('', yearOrDate)\r\n      : this.validate(Calendars.local.invalidYear, yearOrDate, this.minMonth, this.minDay)\r\n    return 400\r\n  }\r\n\r\n  // Retrieve the number of days in a month.\r\n  daysInMonth(date: CDate): number;\r\n  daysInMonth(year: number, month: number): number;\r\n  daysInMonth (yearOrDate: CDate | number, month?: number): number {\r\n    const [, m] = yearOrDate instanceof CDate\r\n      ? this.validate('', yearOrDate)\r\n      : this.validate(Calendars.local.invalidMonth, yearOrDate, month as number, this.minDay, { notDay: true })\r\n    return this.daysPerMonth[m - 1]\r\n  }\r\n\r\n  // Retrieve the number of days in a week.\r\n  daysInWeek (): number {\r\n    return 8\r\n  }\r\n\r\n  // Retrieve the day of the week for a date.\r\n  dayOfWeek(date: CDate): number;\r\n  dayOfWeek(year: number, month: number, day: number): number;\r\n  dayOfWeek (yearOrDate: CDate | number, month?: number, day?: number): number {\r\n    const [, , d] = yearOrDate instanceof CDate\r\n      ? this.validate('', yearOrDate)\r\n      : this.validate(Calendars.local.invalidDate, yearOrDate, month as number, day as number)\r\n    return (d + 1) % 8\r\n  }\r\n\r\n  // Determine whether this date is a week day.\r\n  weekDay(date: CDate): boolean;\r\n  weekDay(year: number, month: number, day: number): boolean;\r\n  weekDay (yearOrDate: CDate | number, month?: number, day?: number): boolean {\r\n    const dow = yearOrDate instanceof CDate\r\n      ? this.dayOfWeek(yearOrDate)\r\n      : this.dayOfWeek(yearOrDate, month as number, day as number)\r\n    return dow >= 2 && dow <= 6\r\n  }\r\n\r\n  // Retrieve additional information about a date - contents depends on calendar.\r\n  extraInfo(date: CDate): Object;\r\n  extraInfo(year: number, month: number, day: number): Object;\r\n  extraInfo (yearOrDate: CDate | number, month?: number, day?: number): Object {\r\n    const [y] = yearOrDate instanceof CDate\r\n      ? this.validate('', yearOrDate)\r\n      : this.validate(Calendars.local.invalidDate, yearOrDate, month as number, day as number)\r\n    return { century: centuries[Math.floor((y - 1) / 100) + 1] || '' }\r\n  }\r\n\r\n  // Retrieve the Julian day number equivalent for this date, i.e. days since January 1, 4713 BCE Greenwich noon.\r\n  toJD(date: CDate): number;\r\n  toJD(year: number, month: number, day: number): number;\r\n  toJD (yearOrDate: CDate | number, month?: number, day?: number): number {\r\n    let [y, m, d] = yearOrDate instanceof CDate\r\n      ? this.validate('', yearOrDate)\r\n      : this.validate(Calendars.local.invalidDate, yearOrDate, month as number, day as number)\r\n    if (y < 0) { y++ }\r\n    return d + (m > 1 ? 16 : 0) + (m > 2 ? (m - 2) * 32 : 0) + (y - 1) * 400 + this.jdEpoch - 1\r\n  }\r\n\r\n  // Create a new date from a Julian day number.\r\n  fromJD (jd: number): CDate {\r\n    jd = Math.floor(jd + 0.5) - Math.floor(this.jdEpoch) - 1\r\n    const year = Math.floor(jd / 400) + 1\r\n    jd -= (year - 1) * 400\r\n    jd += (jd > 15 ? 16 : 0)\r\n    const month = Math.floor(jd / 32) + 1\r\n    const day = jd - (month - 1) * 32 + 1\r\n    return this.date(year <= 0 ? year - 1 : year, month, day)\r\n  }\r\n}\r\n\r\nCalendars.register('discworld', DiscworldCalendar)\r\n\r\nexport { DiscworldCalendar }\r\n"],"file":"Discworld.js"}