{"version":3,"file":"Persian.js","names":["_Calendars","_interopRequireWildcard","require","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","_t","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","_defineProperty","_toPropertyKey","value","enumerable","configurable","writable","_toPrimitive","Symbol","toPrimitive","TypeError","String","Number","mod","a","b","Math","floor","defaultLocalisation","name","epochs","monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","dateFormat","firstDay","isRTL","PersianCalendar","CalendarBase","constructor","language","arguments","length","undefined","localisations","leapYear","yearOrDate","y","CDate","validate","Calendars","local","invalidYear","minMonth","minDay","weekOfYear","month","day","checkDate","date","add","dayOfWeek","dayOfYear","daysInMonth","m","invalidMonth","notDay","daysPerMonth","weekDay","dow","toJD","d","invalidDate","epBase","epYear","jdEpoch","fromJD","jd","dEpoch","cycle","cYear","yCycle","aux1","aux2","year","yDay","ceil","exports","register"],"sources":["../src/Persian.ts"],"sourcesContent":["/* http://keith-wood.name/worldCalendars.html\r\n   Implementation of the Persian or Jalali calendar.\r\n   Based on code from http://www.iranchamber.com/calendar/converter/iranian_calendar_converter.php.\r\n   See also http://en.wikipedia.org/wiki/Iranian_calendar.\r\n   Written by Keith Wood (kbwood.au{at}gmail.com) April 2022.\r\n   Available under the MIT (http://keith-wood.name/licence.html) license.\r\n   Please attribute the author if you use it. */\r\n\r\nimport Calendars, { CalendarBase, CDate } from './Calendars'\r\nimport type { CalendarLocalisation, RegionalLocalisations } from './Calendars'\r\n\r\n// Modulus function which works for non-integers.\r\nconst mod = (a: number, b: number): number => a - (b * Math.floor(a / b))\r\n\r\nconst defaultLocalisation: CalendarLocalisation = {\r\n  name: 'Persian',\r\n  epochs: ['BP', 'AP'],\r\n  monthNames: ['Farvardin', 'Ordibehesht', 'Khordad', 'Tir', 'Mordad', 'Shahrivar',\r\n    'Mehr', 'Aban', 'Azar', 'Day', 'Bahman', 'Esfand'],\r\n  monthNamesShort: ['Far', 'Ord', 'Kho', 'Tir', 'Mor', 'Sha', 'Meh', 'Aba', 'Aza', 'Day', 'Bah', 'Esf'],\r\n  dayNames: ['Yekshanbe', 'Doshanbe', 'Seshanbe', 'Chaharshanbe', 'Panjshanbe', 'Jom\\'e', 'Shanbe'],\r\n  dayNamesShort: ['Yek', 'Do', 'Se', 'ChÃ¦', 'Panj', 'Jom', 'Sha'],\r\n  dayNamesMin: ['Ye', 'Do', 'Se', 'Ch', 'Pa', 'Jo', 'Sh'],\r\n  dateFormat: 'yyyy/mm/dd',\r\n  firstDay: 6,\r\n  isRTL: false\r\n}\r\n\r\nclass PersianCalendar extends CalendarBase {\r\n  // Localisations for the plugin.\r\n  // Entries are objects indexed by the language code ('' being the default US/English). */\r\n  static localisations: RegionalLocalisations = { '': defaultLocalisation }\r\n\r\n  constructor (language: string = '') {\r\n    // Julian date of start of Persian epoch: 19 March 622 CE (Gregorian).\r\n    super('Persian', 1948320.5, PersianCalendar.localisations, language,\r\n      [31, 31, 31, 31, 31, 31, 30, 30, 30, 30, 30, 29])\r\n  }\r\n\r\n  // Determine whether this date is in a leap year.\r\n  leapYear(date: CDate): boolean;\r\n  leapYear(year: number): boolean;\r\n  leapYear (yearOrDate: CDate | number): boolean {\r\n    const [y] = yearOrDate instanceof CDate\r\n      ? this.validate('', yearOrDate)\r\n      : this.validate(Calendars.local.invalidYear, yearOrDate, this.minMonth, this.minDay)\r\n    return (((((y - (y > 0 ? 474 : 473)) % 2820) + 474 + 38) * 682) % 2816) < 682\r\n  }\r\n\r\n  // Determine the week of the year for a date - ISO 8601.\r\n  weekOfYear(date: CDate): number;\r\n  weekOfYear(year: number, month: number, day: number): number;\r\n  weekOfYear (yearOrDate: CDate | number, month?: number, day?: number): number {\r\n    // Find Saturday of this week starting on Saturday\r\n    let checkDate = yearOrDate instanceof CDate\r\n      ? this.date(yearOrDate)\r\n      : this.date(yearOrDate, month as number, day as number)\r\n    checkDate = checkDate.add(-((checkDate.dayOfWeek() + 1) % 7), 'd')\r\n    return Math.floor((checkDate.dayOfYear() - 1) / 7) + 1\r\n  }\r\n\r\n  // Retrieve the number of days in a month.\r\n  daysInMonth(date: CDate): number;\r\n  daysInMonth(year: number, month: number): number;\r\n  daysInMonth (yearOrDate: CDate | number, month?: number): number {\r\n    const [y, m] = yearOrDate instanceof CDate\r\n      ? this.validate('', yearOrDate)\r\n      : this.validate(Calendars.local.invalidMonth, yearOrDate, month as number, this.minDay, { notDay: true })\r\n    return this.daysPerMonth[m - 1] + (m === 12 && this.leapYear(y) ? 1 : 0)\r\n  }\r\n\r\n  // Determine whether this date is a week day.\r\n  weekDay(date: CDate): boolean;\r\n  weekDay(year: number, month: number, day: number): boolean;\r\n  weekDay (yearOrDate: CDate | number, month?: number, day?: number): boolean {\r\n    const dow = yearOrDate instanceof CDate\r\n      ? this.dayOfWeek(yearOrDate)\r\n      : this.dayOfWeek(yearOrDate, month as number, day as number)\r\n    return dow !== 5\r\n  }\r\n\r\n  // Retrieve the Julian day number equivalent for this date, i.e. days since January 1, 4713 BCE Greenwich noon.\r\n  toJD(date: CDate): number;\r\n  toJD(year: number, month: number, day: number): number;\r\n  toJD (yearOrDate: CDate | number, month?: number, day?: number): number {\r\n    const [y, m, d] = yearOrDate instanceof CDate\r\n      ? this.validate('', yearOrDate)\r\n      : this.validate(Calendars.local.invalidDate, yearOrDate, month as number, day as number)\r\n    const epBase = y - (y >= 0 ? 474 : 473)\r\n    const epYear = 474 + mod(epBase, 2820)\r\n    return d + (m <= 7 ? (m - 1) * 31 : (m - 1) * 30 + 6) +\r\n      Math.floor((epYear * 682 - 110) / 2816) + (epYear - 1) * 365 +\r\n      Math.floor(epBase / 2820) * 1029983 + this.jdEpoch - 1\r\n  }\r\n\r\n  // Create a new date from a Julian day number.\r\n  fromJD (jd: number): CDate {\r\n    jd = Math.floor(jd) + 0.5\r\n    const dEpoch = jd - this.toJD(475, 1, 1)\r\n    const cycle = Math.floor(dEpoch / 1029983)\r\n    const cYear = mod(dEpoch, 1029983)\r\n    let yCycle = 2820\r\n    if (cYear !== 1029982) {\r\n      const aux1 = Math.floor(cYear / 366)\r\n      const aux2 = mod(cYear, 366)\r\n      yCycle = Math.floor(((2134 * aux1) + (2816 * aux2) + 2815) / 1028522) + aux1 + 1\r\n    }\r\n    let year = yCycle + (2820 * cycle) + 474\r\n    year = (year <= 0 ? year - 1 : year)\r\n    const yDay = jd - this.toJD(year, 1, 1) + 1\r\n    const month = (yDay <= 186 ? Math.ceil(yDay / 31) : Math.ceil((yDay - 6) / 30))\r\n    const day = jd - this.toJD(year, month, 1) + 1\r\n    return this.date(year, month, day)\r\n  }\r\n}\r\n\r\nCalendars.register('persian', PersianCalendar)\r\nCalendars.register('jalali', PersianCalendar)\r\n\r\nexport { PersianCalendar }\r\n"],"mappings":"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","ignoreList":[]}